name: CI/Python/Lint-Test

on:
  push:
    paths:
      - '**.py'

jobs:
  lint:
    runs-on: ubuntu-latest
    env:
      TF_VAR_lambda: ""
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
          token: ${{ secrets.GH_TOKEN }}

      - uses: actions/setup-python@v2
        with:
          python-version: '3.9' # Version range or exact version of a Python version to use, using SemVer's version range syntax

      - name: Install Pylint 
        run:
          pip install pylint

      - name: Pylint 
        continue-on-error: true
        run:
          pylint src

  test:
    runs-on: ubuntu-latest
    env:
      TF_VAR_lambda: ""
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
          token: ${{ secrets.GH_TOKEN }}

      - uses: actions/setup-python@v2
        with:
          python-version: '3.9' # Version range or exact version of a Python version to use, using SemVer's version range syntax
      - name: Install dependencies
        run:
          pip install pytest pytest-mock boto3 requests

      - name: Test 
        run:
          python -m pytest tests/ -v
